<!DOCTYPE HTML>
<html>
	<head>
        <script src="https://maps.googleapis.com/maps/api/js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <link rel="stylesheet" href="../static/bootstrap-3.3.5-dist/css/bootstrap.css">
        <!-- <script>
            var x = document.getElementById("coords");
            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition);
                } else {
                    x.innerHTML = "Geolocation is not supported by this browser.";
                }
            }
            function showPosition(position) {
                x.innerHTML = "Latitude: " + position.coords.latitude + 
                "<br>Longitude: " + position.coords.longitude; 
            }
        </script> -->
        <title>Food Truck Tracker</title>
        <style>
            #map-canvas {
                width: 500px;
                height: 400px;
                
            }
        </style>
	</head>
	<body>
        <div id="coords"></div>
        <div id="map-canvas"></div>
        <script>
            var x = document.getElementById("coords");
            var lat = 0
            var long = 0
            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition);
                } else {
                    x.innerHTML = "Geolocation is not supported by this browser.";
                }
            }
            function showPosition(position) {
                x.innerHTML = "Latitude: " + position.coords.latitude + 
                "<br>Longitude: " + position.coords.longitude; 
                lat= position.coords.latitude;
                long = position.coords.longitude;
            }
            getLocation()
            
            function initialize() {
                //var position = navigator.geolocation.getCurrentPosition()
                var mapOptions = {   
                    zoom: 8,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    zoom:18
                }
                var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
                var initialLocation = null;
                if(navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        initialLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                        map.setCenter(initialLocation);
                        var marker = new google.maps.Marker({
                            position: initialLocation,
                            map: map,
                            //label: "Hello world!"
                        });
                    });
                }   
                //console.log(initialLocation);
                var marker = new google.maps.Marker({
                    position: new google.maps.LatLng(39, -77),
                    map: map,
                    title: 'sdhfaioha'
                });
                var contentString = '<div id="content">'+
                    '<div id="siteNotice">'+
                    '</div>'+
                    '<h1 id="firstHeading" class="firstHeading">Uluru</h1>'+
                    '<div id="bodyContent">'+
                    '<p><b>Uluru</b>, also referred to as <b>Ayers Rock</b>, is a large ' +
                    'sandstone rock formation in the southern part of the '+
                    'Northern Territory, central Australia. It lies 335&#160;km (208&#160;mi) '+
                    'south west of the nearest large town, Alice Springs; 450&#160;km '+
                    '(280&#160;mi) by road. Kata Tjuta and Uluru are the two major '+
                    'features of the Uluru - Kata Tjuta National Park. Uluru is '+
                    'sacred to the Pitjantjatjara and Yankunytjatjara, the '+
                    'Aboriginal people of the area. It has many springs, waterholes, '+
                    'rock caves and ancient paintings. Uluru is listed as a World '+
                    'Heritage Site.</p>'+
                    '<p>Attribution: Uluru, <a href="https://en.wikipedia.org/w/index.php?title=Uluru&oldid=297882194">'+
                    'https://en.wikipedia.org/w/index.php?title=Uluru</a> '+
                    '(last visited June 22, 2009).</p>'+
                    '</div>'+
                    '</div>';    
                var infoWindow = new google.maps.InfoWindow({
                    content: contentString
                });
                google.maps.event.addListener(marker, 'click', function() {
                    infoWindow.open(map,marker);
                });
          
            }
            google.maps.event.addDomListener(window, 'load', initialize);
            /*
            $(document).ready(function() {
                alert('lel')
                var request = $.ajax({
                    type: "POST",
                    url: "/truck_array/",
                    data: {"name":""}, // if you wanted to specifiy what list then pass an actual name
                    dataType: "html"
                });

                request.done(function(JSON_array) {
                    array_data = JSON.parse(JSON_array)["array"]
                    //from here you have your array to play with
                });
            });
            */
            
              $(document).ready(function() {
                alert('lel')
                var request = $.ajax({
                    type: "POST",
                    url: "/truck_array",
                    data: {"name":""}, // if you wanted to specifiy what list then pass an actual name
                    dataType: "html"
                });

                request.done(function(JSON_array_string) {
                    //alert(JSON_array);
                    array_data = JSON.parse(JSON_array_string)
                    //alert(array_data)
                    /*
                    for(i=0; i<array_data.length; i++)
                    {
                        alert(array_data[i]["food_truck_name"])
                    }
                    */
                    //from here you have your array to play with
                });
            });

        </script>
	</body>
</html>